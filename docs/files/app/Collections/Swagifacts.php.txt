<?php

namespace Swag\App\Collections;

use Swag\Framework\Collection;
use Swag\App\Models\H5P;
use Swag\App\Models\Swagpath;

class Swagifacts extends Collection {
  public function __construct($data, $swagpath)
  {
    if (is_array($data)) {
      $swagifacts = array_map(function($swagifact) use ($swagpath) { return new H5P($swagifact, $swagpath); }, $data);
      $this->data = $swagifacts;
    }
  }

  /**
   * Create Swagifacts collection from an array of IDs
   *
   * @param array $ids
   * @return Swagifacts
   */
  public static function create_from_ids(array $ids, Swagpath $swagpath): Swagifacts {
    global $wpdb;
    $ids = implode(',', $ids);

    $results = $wpdb->get_results("SELECT * FROM {$wpdb->prefix}h5p_contents WHERE id IN ($ids) ORDER BY FIELD(id, $ids)", ARRAY_A);

    return new static($results, $swagpath);
  }
}
